<supervisor xmlns="urn:ietf:params:xml:ns:yang:nemea">
  <available-module>
    <name>ipfixcol</name>
    <path>/usr/bin/ipfixcol</path>
    <description>TODO</description>
    <use-trap-ifces>false</use-trap-ifces>
    <trap-monitorable>true</trap-monitorable>
    <is-sysrepo-ready>false</is-sysrepo-ready>
  </available-module>
  <available-module>
    <name>ipfixsend</name>
    <path>/usr/bin/ipfixsend</path>
    <description>TODO</description>
    <use-trap-ifces>false</use-trap-ifces>
    <trap-monitorable>false</trap-monitorable>
    <is-sysrepo-ready>false</is-sysrepo-ready>
  </available-module>
  <available-module>
    <name>vportscan_detector</name>
    <path>/usr/bin/nemea/vportscan_detector</path>
    <description>TODO</description>
    <use-trap-ifces>true</use-trap-ifces>
    <trap-monitorable>true</trap-monitorable>
    <is-sysrepo-ready>false</is-sysrepo-ready>
  </available-module>
  <instance>
    <name>ipfixcol1</name>
    <module-ref>ipfixcol</module-ref>
    <enabled>true</enabled>
    <interface>
      <name>if1</name>
      <type>UNIXSOCKET</type>
      <direction>OUT</direction>
    </interface>
    <interface>
      <name>if2</name>
      <type>UNIXSOCKET</type>
      <direction>OUT</direction>
    </interface>
    <params>-c /data/ipfixcol-files/ipfixcol-startup.xml -p /tmp/ipfixcol.pid</params>
  </instance>
  <instance>
    <name>ipfixsend1</name>
    <module-ref>ipfixsend</module-ref>
    <enabled>true</enabled>
    <params>-i /data/ipfixcol-files/data.ipfix -R 0.5</params>
  </instance>
  <instance>
    <name>vportscan_detector1</name>
    <module-ref>vportscan_detector</module-ref>
    <enabled>true</enabled>
    <interface>
      <name>if1</name>
      <type>UNIXSOCKET</type>
      <direction>IN</direction>
      <unix-params>
        <socket-name>flow_data_source</socket-name>
      </unix-params>
    </interface>
    <interface>
      <name>if2</name>
      <type>UNIXSOCKET</type>
      <direction>OUT</direction>
      <unix-params>
        <socket-name>vportscan_out</socket-name>
      </unix-params>
    </interface>
    <params>-vvv</params>
  </instance>
</supervisor>
