<?xml version="1.0"?>
<supervisor xmlns="urn:ietf:params:xml:ns:yang:nemea">
  <available-module>
    <name>ipfixcol</name>
    <path>/usr/bin/ipfixcol</path>
    <description>TODO</description>
    <is-nemea-module>false</is-nemea-module>
    <is-sysrepo-ready>false</is-sysrepo-ready>
    <sysrepo-callbacks-ready>false</sysrepo-callbacks-ready>
  </available-module>
  <available-module>
    <name>ipfixsend</name>
    <path>/usr/bin/ipfixsend</path>
    <description>TODO</description>
    <is-nemea-module>false</is-nemea-module>
    <is-sysrepo-ready>false</is-sysrepo-ready>
    <sysrepo-callbacks-ready>false</sysrepo-callbacks-ready>
  </available-module>
  <available-module>
    <name>vportscan_detector</name>
    <path>/usr/bin/nemea/vportscan_detector</path>
    <description>TODO</description>
    <is-nemea-module>true</is-nemea-module>
    <is-sysrepo-ready>false</is-sysrepo-ready>
    <sysrepo-callbacks-ready>false</sysrepo-callbacks-ready>
    <in-ifc-cnt>1</in-ifc-cnt>
    <out-ifc-cnt>0</out-ifc-cnt>
  </available-module>


  <module>
    <name>ipfixcol1</name>
    <module-ref>ipfixcol</module-ref>
    <enabled>true</enabled>
    <params>-c /data/ipfixcol-files/ipfixcol-startup.xml -p /tmp/ipfixcol.pid</params>
  </module>
  <module>
    <name>ipfixsend1</name>
    <module-ref>ipfixsend</module-ref>
    <enabled>true</enabled>
    <params>-i /data/ipfixcol-files/data.ipfix -R 0.5</params>
  </module>
  <module>
    <name>vportscan_detector1</name>
    <module-ref>vportscan_detector</module-ref>
    <enabled>true</enabled>
    <params>-vvv</params>

    <interface>
      <name>if1</name>
      <type>UNIXSOCKET</type>
      <direction>IN</direction>
      <unix-params>
        <socket-name>flow_data_source</socket-name>
      </unix-params>
    </interface>
    <interface>
      <name>if2</name>
      <type>UNIXSOCKET</type>
      <direction>OUT</direction>
      <unix-params>
        <socket-name>vportscan_out</socket-name>
      </unix-params>
    </interface>
  </module>
</supervisor>
